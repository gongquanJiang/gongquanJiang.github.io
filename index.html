<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl"/>
  
  
  
  
  <title>番茄&#39;Jiang</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="hexo+github搭建的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="番茄&#39;Jiang">
<meta property="og:url" content="https://gongquanJiang.github.io/index.html">
<meta property="og:site_name" content="番茄&#39;Jiang">
<meta property="og:description" content="hexo+github搭建的博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="番茄&#39;Jiang">
<meta name="twitter:description" content="hexo+github搭建的博客">
  
    <link rel="alternative" href="/atom.xml" title="番茄&#39;Jiang" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.jpg">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

        <a href="/" class="profilepic">
            
            <img lazy-src="/img/avatar.jpg" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">成熟的汪</a></h1>
        </hgroup>
        
        <p class="header-subtitle">life is beautiful like sunshine!</p>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder="搜索一下" autocomplete="off">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="/archives/">所有文章</a></li>
                        
                            <li><a  href="/tags">分类及标签</a></li>
                        
                            <li><a  href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github"  target="_blank" href="https://github.com/gongquanJiang/gongquanJiang.github.io" title="github">github</a>
                            
                                <a class="fl weibo"  target="_blank" href="https://weibo.com/u/6231526458/home?wvr=5&lf=reg" title="weibo">weibo</a>
                            
                                <a class="fl rss"  target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/requests模块/" style="font-size: 10px;">requests模块</a> <a href="/tags/三种不同类型的网页爬取/" style="font-size: 10px;">三种不同类型的网页爬取</a> <a href="/tags/四级/" style="font-size: 10px;">四级</a> <a href="/tags/待续/" style="font-size: 10px;">待续...</a> <a href="/tags/数据提取方法/" style="font-size: 10px;">数据提取方法</a> <a href="/tags/英语/" style="font-size: 10px;">英语</a> <a href="/tags/语言/" style="font-size: 10px;">语言</a>
                    </div>
                </section>
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://jiangsir12356.github.io">github</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://blog.csdn.net/baidu_21483933">csdn</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://segmentfault.com/blog/maocg_web">segmentfault</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.jianshu.com/users/eb37ef89c746/latest_articles">简书</a>
                    
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">爱动漫,爱游戏,爱编程,爱运动,爱折腾!</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">成熟的汪</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/avatar.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">成熟的汪</a></h1>
            </hgroup>
            
            <p class="header-subtitle">life is beautiful like sunshine!</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags">分类及标签</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/gongquanJiang/gongquanJiang.github.io" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="https://weibo.com/u/6231526458/home?wvr=5&lf=reg" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-决战四级" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2018/09/03/决战四级/" class="article-date">
      <time datetime="2018-09-03T02:20:52.000Z" itemprop="datePublished">2018-09-03</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2018/09/03/决战四级/">决战四级</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="决战四级-濒临改革"><a href="#决战四级-濒临改革" class="headerlink" title="决战四级(濒临改革)"></a>决战四级(濒临改革)</h2><h3 id="1、了解四级"><a href="#1、了解四级" class="headerlink" title="1、了解四级"></a>1、了解四级</h3><ul>
<li>各个科目的分值分配<br>写作: 30min 15% 106.5<br>听力: 25min 35% 248.5<br>阅读: 40min 35% 248.5<br>翻译: 30min 15% 106.5</li>
<li>四级词汇<ul>
<li>会写: 写作+翻译(熟读熟记700-800，勿背模板)</li>
<li>会认: 阅读(熟词僻义+同义替换，经济学人，仔细阅读真题阅读，圈生词，勾词组)</li>
<li>会用: 翻译(真题积累词汇)<ul>
<li>词根词缀法: 后缀—改变单词词性    词根—决定单词意思   前缀–改变单词意思  </li>
<li>词源法:  </li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/语言/">语言</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/四级/">四级</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/英语/">英语</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-markdown语法" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2018/08/28/markdown语法/" class="article-date">
      <time datetime="2018-08-28T05:23:18.000Z" itemprop="datePublished">2018-08-28</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2018/08/28/markdown语法/">markdown语法</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="书写格式Markdown"><a href="#书写格式Markdown" class="headerlink" title="书写格式Markdown"></a>书写格式Markdown</h2><h3 id="1、行间文字"><a href="#1、行间文字" class="headerlink" title="1、行间文字"></a>1、行间文字</h3><ul>
<li>用法： 通常用一对`表示加上底色的行间文字<ul>
<li>实例: `底色行间文字`</li>
</ul>
</li>
</ul>
<h3 id="2、标题制作"><a href="#2、标题制作" class="headerlink" title="2、标题制作"></a>2、标题制作</h3><ul>
<li>用法: 文字左边添加#表示标题,且#的数量决定了标题的级别，最多可以表示六级<ul>
<li>实例: # 一级标题 ## 二级标题……######六级标题</li>
</ul>
</li>
</ul>
<h3 id="3、改变字体"><a href="#3、改变字体" class="headerlink" title="3、改变字体"></a>3、改变字体</h3><ul>
<li>用法: 粗体: 用一对**表示强调,显示粗体<ul>
<li>实例: **加粗内容**</li>
</ul>
</li>
<li>用法: 斜体: 用一对*表示斜体<ul>
<li>实例: *斜体内容*</li>
</ul>
</li>
</ul>
<ul>
<li>附加用法: ***斜体+加粗内容***</li>
</ul>
<h3 id="4、代码区设置"><a href="#4、代码区设置" class="headerlink" title="4、代码区设置"></a>4、代码区设置</h3><ul>
<li>用法1:<br>```什么语言(python、bash…)<br>代码块<br>```</li>
<li>行内代码块，不加语言类型,用法2:<br> ```<br> 代码块<br> ```</li>
<li>用法3:<ul>
<li>行的开头空4个空格/一个tab，表示接下来的内容是程序代码</li>
<li>注意事项:<br>(1)在代码区块内部，”, &lt;&gt;,&amp; 将会自动转换为转义字符<br>(2)在代码区块内部，Markdown 不被解释为特殊标记,即：星号(*)就是星号(*)，</li>
</ul>
</li>
</ul>
<h3 id="5、格式工具"><a href="#5、格式工具" class="headerlink" title="5、格式工具"></a>5、格式工具</h3><ul>
<li>换行、分段标记: 行尾敲两个空格,然后回车键</li>
<li>分割标记: 三个以上的***或者---</li>
<li>转义字符: \, 无需转义的 &lt; 和 &amp;</li>
</ul>
<h3 id="6、删除文字"><a href="#6、删除文字" class="headerlink" title="6、删除文字"></a>6、删除文字</h3><ul>
<li>用法: ~~删除文字~~</li>
</ul>
<h3 id="7、无序列表"><a href="#7、无序列表" class="headerlink" title="7、无序列表"></a>7、无序列表</h3><p>- 内容(+、-、*效果相同)<br>空格- 子内容1<br>空格- 子内容2</p>
<h3 id="8、有序列表"><a href="#8、有序列表" class="headerlink" title="8、有序列表"></a>8、有序列表</h3><ol>
<li>内容1</li>
<li>内容2<br><code>注: 两个列表之间不能相邻，否则会解释为嵌套的列表</code></li>
</ol>
<h3 id="9、链接工具"><a href="#9、链接工具" class="headerlink" title="9、链接工具"></a>9、链接工具</h3><ul>
<li>地址: [ 文字 ] (超链接地址)</li>
<li>图片: ![ 图片名，没有则空格代替 ] (本地或者url图片地址)<ul>
<li>限制图片大小并居中</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;图片地址&quot; width=&quot;图片显示宽度&quot; height=&quot;显示高度&quot;  </span><br><span class="line">alt=&quot;图片名称&quot;/&gt;设置图片大小，再用&lt;div align=center&gt;&lt;/div&gt;命令包裹达到居中效果。</span><br></pre></td></tr></table></figure>
<h3 id="10、公式"><a href="#10、公式" class="headerlink" title="10、公式"></a>10、公式</h3><p><a href="http://www.codecogs.com/latex/eqneditor.php" target="_blank" rel="noopener"> LaTeX公式转化工具 </a></p>
<ul>
<li>引用转化后的&lt;img…/&gt;代码<ul>
<li>实例:<br><img src="http://latex.codecogs.com/gif.latex?a^2&plus;b^2=c^2" title="a^2+b^2=c^2"></li>
</ul>
</li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#cmd-markdown" target="_blank" rel="noopener">https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#cmd-markdown</a><br><a href="http://www.tuicool.com/articles/fmeMbqR" target="_blank" rel="noopener">http://www.tuicool.com/articles/fmeMbqR</a><br><img src="http://pe7iy00p6.bkt.clouddn.com/imgpexels-photo-802647.jpg" alt=" 惬意生活 "></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Markdown/">Markdown</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/语言/">语言</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-爬虫进阶" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2018/08/27/爬虫进阶/" class="article-date">
      <time datetime="2018-08-27T04:58:59.000Z" itemprop="datePublished">2018-08-27</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2018/08/27/爬虫进阶/">爬虫进阶</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="数据提取方法"><a href="#数据提取方法" class="headerlink" title="数据提取方法"></a>数据提取方法</h2><h3 id="json"><a href="#json" class="headerlink" title="json"></a>json</h3><ul>
<li>数据交换格式(后端转换到前端)，看起来像python类型(字典、集合…)的字符串</li>
<li>使用json之前需要导入模块</li>
<li>哪里会返回json数据<ul>
<li>浏览器切换到手机版</li>
<li>抓包app</li>
</ul>
</li>
<li>jsom.loads<ul>
<li>把json字符串转化为python类型</li>
<li><code>json.loads(&#39;json字符串&#39;)</code></li>
</ul>
</li>
<li>json.dump<ul>
<li>把python类型转化为json字符串</li>
<li><code>json.dumps(&#39;{python字典}&#39;)</code></li>
<li>json.dumps(ret1,ensure_ascii=False,indent=2)<ul>
<li>ensure_ascii : 让中文显示成中文</li>
<li>indent: 能够让下一行在上一行的基础上空格， indent = 2</li>
</ul>
</li>
</ul>
</li>
<li>豆瓣电视爬虫案例<ul>
<li>preview<code>搜索需要的爬取的内容</code></li>
<li>Filter 过滤显示输入字段的url地址</li>
<li>案例实现代码:</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=gbk</span></span><br><span class="line"><span class="keyword">from</span> parse <span class="keyword">import</span> parse_url</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoubanSpider</span>:</span></span><br><span class="line">    <span class="string">"""豆瓣内容抓取"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment">#最开始的入口</span></span><br><span class="line">        self.temp_url = <span class="string">"https://movie.douban.com/j/search_subjects?type=tv&amp;tag=%E7%BE%8E%E5%89%A7&amp;sort=recommend&amp;page_limit=20&amp;page_start=&#123;&#125;"</span>       <span class="comment"># &#123;&#125;大括号里对应字段传入值num的.format(num)</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_content_list</span><span class="params">(self,html_str)</span>:</span>  <span class="comment">#提取数据</span></span><br><span class="line">        dict_data = json.loads(html_str)   <span class="comment">#有callback就删除</span></span><br><span class="line">        content_list = dict_data[<span class="string">"subjects"</span>]</span><br><span class="line">        <span class="comment">#total = dict_data["total"] 没有total的话自己设置</span></span><br><span class="line">        <span class="keyword">return</span> content_list   <span class="comment">#,total</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save_content_list</span><span class="params">(self,content_list)</span>:</span></span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">"douban.json"</span>,<span class="string">"a"</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> content <span class="keyword">in</span> content_list:</span><br><span class="line">                 f.write(json.dumps(content,ensure_ascii=<span class="keyword">False</span>)) </span><br><span class="line">                 f.write(<span class="string">"\n"</span>)</span><br><span class="line">        print(<span class="string">'保存成功'</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span>  <span class="comment">#实现主要逻辑</span></span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        <span class="comment">#total = 100  初始化total,第二页更新时不使用</span></span><br><span class="line">        <span class="keyword">while</span> num &lt; <span class="number">100</span>: <span class="comment">#num &lt; total+ page_limit 全部提取数据</span></span><br><span class="line">            <span class="comment">#1.start_url</span></span><br><span class="line">            url = self.temp_url.format(num)  <span class="comment">#对start进行复制</span></span><br><span class="line">            print(url)</span><br><span class="line">            <span class="comment">#2.发送请求，获取响应</span></span><br><span class="line">            html_str = parse_url(url)</span><br><span class="line">            <span class="comment">#3.提取数据</span></span><br><span class="line">            content_list = self.get_content_list(html_str) <span class="comment">#content,tatal = </span></span><br><span class="line">            <span class="comment">#4.保存</span></span><br><span class="line">            self.save_content_list(content_list)</span><br><span class="line">            <span class="comment">#5.构造下一页的url，循环2-5步</span></span><br><span class="line">            num += <span class="number">20</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    douban = DoubanSpider()   <span class="comment">#实例化</span></span><br><span class="line">    douban.run()</span><br></pre></td></tr></table></figure>
<h3 id="xpath和lxml"><a href="#xpath和lxml" class="headerlink" title="xpath和lxml"></a>xpath和lxml</h3><h4 id="xpath"><a href="#xpath" class="headerlink" title="xpath"></a>xpath</h4><ul>
<li>一门从html中提取数据的语言<ul>
<li>xpath语法</li>
</ul>
</li>
<li>xpath helper插件:帮助我们从<code>element</code>中定位数据<ul>
<li>1.选择节点(标签)</li>
<li><code>/html/head/meta</code>: 能够选中html下的所有meta标签</li>
<li>2.<code>//</code> : 能够选择任意标签</li>
<li><code>//li</code>: 当前页面上所有li标签</li>
<li><code>/html/meta//link</code>: 结合使用显示meta下的link标签</li>
<li>3.<code>@符号用途</code></li>
<li>选择具体属性值</li>
<li><code>//div[@class=&#39;feed-infinite-wrapper&#39;]/ul/li</code>: 选择class=’feed-infinite-wrapper’的div下的ul下的li</li>
<li><code>//div[@class=&#39;feed-infinite-wrapper&#39;]/ul/li/a/@href</code>:选择a标签的href值</li>
<li>4.获取a标签下的文本: <code>/a/text()</code></li>
<li>标签下的所有文本: <code>/a//text()</code></li>
<li>5.点前</li>
<li>“./a” 当前节点下的a标签</li>
</ul>
</li>
</ul>
<h4 id="lxml"><a href="#lxml" class="headerlink" title="lxml"></a>lxml</h4><ul>
<li>安装: pip install lxml<ul>
<li>使用:<br>from lxml import etree<br>element = etree.HTML(‘接受的html字符串’)  #转化为element对象<br>element.xpath(“”)   #url地址对应响应，网页源码，只有elements和url响应相同时才能看elements</li>
</ul>
</li>
<li>实现代码:                         <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line">url = <span class="string">"https://movie.douban.com/chart"</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"User_Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36"</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url,headers=headers)</span><br><span class="line">html_str = response.content.decode()</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(html_str)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用etree处理数据</span></span><br><span class="line">html = etree.HTML(html_str)</span><br><span class="line"><span class="comment">#print(html)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1.获取所有电影图片地址</span></span><br><span class="line">img_list = html.xpath(<span class="string">"//div[@class='indent']/div/table//a[@class='nbg']/img/@src"</span>)</span><br><span class="line"><span class="comment">#print('movie_img地址: \n\t'+str(img_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.获取所有电影的url地址</span></span><br><span class="line">url_list = html.xpath(<span class="string">"//div[@class='indent']/div/table//div[@class='pl2']/a/@href"</span>)</span><br><span class="line"><span class="comment">#print(url_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.每部电影元素组成字典,字典中包含标题、url、图片地址、评论数、评分</span></span><br><span class="line"><span class="comment">#思路:</span></span><br><span class="line"><span class="comment">#(1)分组</span></span><br><span class="line"><span class="comment">#(2)每一组提取数据</span></span><br><span class="line"></span><br><span class="line">ret1 = html.xpath(<span class="string">"//div[@class='indent']/div/table"</span>)</span><br><span class="line"><span class="comment">#print(ret1)  #这是一个列表式element对象,即标签节点</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> table <span class="keyword">in</span> ret1:</span><br><span class="line">    <span class="comment">#当[0]为空时会报错，先判断是否为null</span></span><br><span class="line">    item = &#123;&#125;     <span class="comment">#空集合</span></span><br><span class="line">    item[<span class="string">'title'</span>] = table.xpath(<span class="string">".//div[@class='pl2']/a/text()"</span>)[<span class="number">0</span>].replace(<span class="string">'/'</span>,<span class="string">''</span>).strip()<span class="comment">#当前节点下续写</span></span><br><span class="line">    item[<span class="string">'href'</span>] = table.xpath(<span class="string">".//div[@class='pl2']/a/@href"</span>)[<span class="number">0</span>]</span><br><span class="line">    item[<span class="string">'img'</span>] = table.xpath(<span class="string">".//a[@class='nbg']/img/@src"</span>)[<span class="number">0</span>]</span><br><span class="line">    item[<span class="string">'comment_num'</span>] = table.xpath(<span class="string">".//span[@class='pl']/text()"</span>)[<span class="number">0</span>]</span><br><span class="line">    item[<span class="string">'rating_num'</span>] = table.xpath(<span class="string">".//span[@class='rating_nums']/text()"</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="comment">#列表推导式</span></span><br><span class="line">    <span class="comment">#item["title"] = [for i in item["title"]]  #正则</span></span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/python爬虫/">python爬虫</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据提取方法/">数据提取方法</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-爬虫初阶" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2018/08/27/爬虫初阶/" class="article-date">
      <time datetime="2018-08-27T03:56:08.000Z" itemprop="datePublished">2018-08-27</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2018/08/27/爬虫初阶/">爬虫初阶</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="爬虫概念、工具和HTTP"><a href="#爬虫概念、工具和HTTP" class="headerlink" title="爬虫概念、工具和HTTP"></a>爬虫概念、工具和HTTP</h2><h3 id="1、什么是爬虫"><a href="#1、什么是爬虫" class="headerlink" title="1、什么是爬虫"></a>1、什么是爬虫</h3><ul>
<li>爬虫就是<code>模拟客户端(浏览器)发送网络请求</code>，获取服务器响应，按照规则提取数据的程序</li>
</ul>
<h3 id="2、爬虫数据去哪了"><a href="#2、爬虫数据去哪了" class="headerlink" title="2、爬虫数据去哪了"></a>2、爬虫数据去哪了</h3><ul>
<li>网页呈现出来（不是做新闻的app通过爬虫抓取新闻）</li>
<li>进行分析 (从数据中分析想要的（大公司拥有大数据，小公司抓取数据）<br>实例: 爬取小说、新闻等呈现到前端页面</li>
</ul>
<h3 id="3、-浏览器的请求"><a href="#3、-浏览器的请求" class="headerlink" title="3、 浏览器的请求"></a>3、 浏览器的请求</h3><ul>
<li>url<ul>
<li>在chrome中点击检查，点击网络network</li>
<li>url = 请求协议 + 网络域名、主机名 + 资源路径 +? 参数</li>
</ul>
</li>
<li>小技巧: url解码工具： 将url地址解码，可以将参数具体</li>
<li>浏览器请求url出现大量字符串元素（网页元素由大量工具编写js、css)<ul>
<li>当前url对应响应 + js + css + 图片 —–即elements中的内容</li>
</ul>
</li>
<li>爬虫请求url地址<ul>
<li>当前url对应响应</li>
</ul>
</li>
<li>elements的内容和爬虫获取的url地址对应的响应不同，爬虫中需要以当前url地址对应响应为准提取数据</li>
<li>当前url地址对应的响应在哪<ul>
<li>从network中找到当前url地址，点击response</li>
<li>或者在页面上右键显示网页源码(对于更新快的网页，网页源码中元素可能不断改变)</li>
</ul>
</li>
</ul>
<h3 id="4、-认识HTTP、HTTPS"><a href="#4、-认识HTTP、HTTPS" class="headerlink" title="4、 认识HTTP、HTTPS"></a>4、 认识HTTP、HTTPS</h3><ul>
<li>HTTP: 超文本传输协议<ul>
<li>以明文形式传输</li>
<li>效率高、不安全</li>
</ul>
</li>
<li>HTTPS: HTTP+SSL(安全套接字层)<ul>
<li>每次传输之前数据先加密，之后解密获取</li>
<li>效率低、安全</li>
</ul>
</li>
<li>get请求和post请求的区别<ul>
<li>get请求没有请求体，post含有，get请求把数据放到url地址中</li>
<li>post请求常用于登录注册</li>
<li>post请求携带的数据量比get请求大，多，常用于传输大文本</li>
</ul>
</li>
</ul>
<ul>
<li>HTTP之请求<br>Request Header<br>view parms<ul>
<li>请求行</li>
<li>请求头 Host、Connection、cache-Control、   User-Agent用户代理：(对方服务器了解访问者是什么浏览器、还是爬虫)<br>如果我们需要模拟手机版浏览器则修改User-Agent,并选择相应型号手机<ul>
<li>Cookie： 用来存储用户信息、每次请求会被携带上发送给对方的浏览器</li>
<li>要获取登录后才能访问的页面</li>
<li>对方的服务器会通过cookie来判断我们是否是一个爬虫</li>
</ul>
</li>
</ul>
<ul>
<li>请求体</li>
<li>携带数据</li>
<li>get请求没有请求体，post含有</li>
</ul>
</li>
</ul>
<ul>
<li>HTTP协议之响应<ul>
<li>1.响应头</li>
<li>Set-Cookie: 对方服务器通过该字段设置Cookie(cookies查看)到本地</li>
<li>2.响应体</li>
<li>url地址对应的响应</li>
</ul>
</li>
</ul>
<h2 id="requests模块"><a href="#requests模块" class="headerlink" title="requests模块"></a>requests模块</h2><h3 id="1、-使用前安装"><a href="#1、-使用前安装" class="headerlink" title="1、 使用前安装"></a>1、 使用前安装</h3><p>pip install requests</p>
<h3 id="2、-get-post响应请求"><a href="#2、-get-post响应请求" class="headerlink" title="2、 get/post响应请求"></a>2、 get/post响应请求</h3><ul>
<li>response = requests.get(url)  #发送get请求，请求url地址对应的响应</li>
<li>response = requests.post(url, data = {请求的字典}) #发送post请求并附带请求体，请求url地址对应的响应</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot; &quot;</span><br><span class="line">query_string = &#123;&quot;query&quot;:&quot;.....&quot;,</span><br><span class="line">                 &quot;from&quot;:&quot;zh&quot;,</span><br><span class="line">                 &quot;to&quot;:&quot;en&#125;</span><br><span class="line">headers = &#123;&quot;User-Agent&quot;:&quot;......&quot;网页Fn+12赋值&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url,data = query_string，headers = headers)</span><br><span class="line">print(response) #判断请求正常发送出去，服务器响应</span><br><span class="line">print(response.content.decode())</span><br></pre></td></tr></table></figure>
<h3 id="3、response方法"><a href="#3、response方法" class="headerlink" title="3、response方法"></a>3、response方法</h3><ul>
<li>response.text<br>大部分都会出现乱码，一般加上resonse.encoding = ‘utf-8’ </li>
<li>response.content.decode()<br>二进制字节流byte形式显示，一般加上decode()转化为str类型</li>
<li>response.encoding = response.apparent_encoding<br>通过网页内容分析编码 </li>
<li>response.request.url  #发送请求的url地址，字符串</li>
<li>response.url          #response相应的url地址,页面跳转和前面一个不一样</li>
<li>response.request.headers #请求头，字典</li>
<li>response.headers #响应头  </li>
</ul>
<h3 id="4、获取网页源码正确打开方式"><a href="#4、获取网页源码正确打开方式" class="headerlink" title="4、获取网页源码正确打开方式"></a>4、获取网页源码正确打开方式</h3><ol>
<li>response.content.decode()     </li>
<li>response.content.decode(“gbk”)</li>
<li>response.text      #requests根据头部猜测，该方式往往出现乱码，解决response.encoding=’utf-8’</li>
<li>response.text.encode(‘GBK’,’ignore’).decode(‘gbk’)</li>
</ol>
<h3 id="5、发送header请求"><a href="#5、发送header请求" class="headerlink" title="5、发送header请求"></a>5、发送header请求</h3><ul>
<li><code>目的为了模拟浏览器，获取和浏览器一模一样的内容</code><br>headers = {“User-Agent”:……网页Fn+12赋值}<br>“Referer”:”…..”<br>更多的参数尝试</li>
</ul>
<p>response = requests.get(url,headers = headers)<br>response = requests.post(url,data = data,headers=headers)</p>
<h3 id="6、使用超时参数"><a href="#6、使用超时参数" class="headerlink" title="6、使用超时参数"></a>6、使用超时参数</h3><ul>
<li>requests.get(url,headers = headers,timeout=3) #3秒内必须返回，否则报错</li>
</ul>
<h3 id="7、retrying模块学习"><a href="#7、retrying模块学习" class="headerlink" title="7、retrying模块学习"></a>7、retrying模块学习</h3><ul>
<li>pip install retrying</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from retrying import retry</span><br><span class="line"></span><br><span class="line">@retry(stop_max_attempt_number=3)   #让被装饰的函数，反复请求3次，三次报错才报错，只要有一次正确请求则返回</span><br><span class="line">def fun1():</span><br><span class="line">    print(&quot;this is fun1&quot;)</span><br><span class="line">    raise ValueErro(&quot;this is test error)  #报错效果</span><br></pre></td></tr></table></figure>
<h4 id="8、详细代码"><a href="#8、详细代码" class="headerlink" title="8、详细代码"></a>8、详细代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">headers = &#123;&quot;User-Agent&quot;:&quot;.....&quot;&#125;</span><br><span class="line"></span><br><span class="line">@retry(stop_max_attempt_number=3)</span><br><span class="line">def _parse_url(url):</span><br><span class="line">    print(&quot;*&quot;*100)   #检测</span><br><span class="line">    response = requests.get(url,headers=headers,timeout)</span><br><span class="line">    return response.content.decode()</span><br><span class="line"></span><br><span class="line">def parse_url(url):</span><br><span class="line">     try:</span><br><span class="line">         html_str = _parse_url(url)</span><br><span class="line">     except:</span><br><span class="line">         html_str = None</span><br><span class="line">     return html_str</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:         #本模块执行</span><br><span class="line">    url = &quot;http://www.baidu.com&quot;</span><br><span class="line">    print(parse_url(url)[:100])    #取字符串前100</span><br></pre></td></tr></table></figure>
<h3 id="9、requests处理Cooike相关请求"><a href="#9、requests处理Cooike相关请求" class="headerlink" title="9、requests处理Cooike相关请求"></a>9、requests处理Cooike相关请求</h3><ul>
<li>人人网(“email”:”<a href="mailto:mr_mao_hacker@163.com" target="_blank" rel="noopener">mr_mao_hacker@163.com</a>“,”password”:”alarmchime”)</li>
<li>方式一: 直接携带Cooike请求url地址</li>
</ul>
<ol>
<li>cookie放在headers中<br>1.1 headers = {“User-Agent”:”…”,<br>  “Cookie”:”…”}</li>
<li>cookie字典传给cookies参数<br>requests.get(url,cookies  = cookie_dict)</li>
</ol>
<ul>
<li>方式二: 先发送post请求，获取cookie，带上cookie请求登录后的页面</li>
</ul>
<ol>
<li>session = requests.session()   # 帮助和服务端回话保持| 方法和request相同</li>
<li>session.post(url,data,headers) #服务器设置在本地的cookie会保存在session中</li>
<li>session.get(url)   #会带上之前保存在session中的cookie,能够请求成功</li>
</ol>
<h3 id="10、在使用session-请求登录后的页面"><a href="#10、在使用session-请求登录后的页面" class="headerlink" title="10、在使用session 请求登录后的页面"></a>10、在使用session 请求登录后的页面</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url = &quot;.....&quot;</span><br><span class="line">response = session.get(url,headers=headers)</span><br><span class="line">with open(&quot;renren3.html&quot;,&quot;w&quot;,encoding=&apos;utf-8&apos;) as f:</span><br><span class="line">    f.write(response.content.decode()</span><br></pre></td></tr></table></figure>
<h3 id="11、三种方式爬虫案例"><a href="#11、三种方式爬虫案例" class="headerlink" title="11、三种方式爬虫案例"></a>11、三种方式爬虫案例</h3><h4 id="1-requests-get实现页面爬取-百度首页"><a href="#1-requests-get实现页面爬取-百度首页" class="headerlink" title="1.requests-get实现页面爬取(百度首页)"></a>1.requests-get实现页面爬取(百度首页)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> retrying <span class="keyword">import</span> retry</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1"</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@retry(stop_max_attempt_number=3) #装饰函数反复请求，三次请求都失败报错</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_page</span><span class="params">(get_url)</span>:</span></span><br><span class="line">    <span class="string">"""get()方法请求内容"""</span></span><br><span class="line">    print(<span class="string">'*'</span>*<span class="number">10</span>)   <span class="comment">#用于检测请求次数</span></span><br><span class="line">    r = requests.get(get_url,headers=headers,timeout=<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">return</span> r.text.encode(<span class="string">'GBK'</span>,<span class="string">'ignore'</span>).decode(<span class="string">'gbk'</span>)  <span class="comment">#解决不支持'gbk'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_page</span><span class="params">(get_url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        html_str = get_page(get_url)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        html_str = <span class="string">'Error'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'baidu_get.text'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(html_str[:<span class="number">500</span>])      <span class="comment">#正确执行写入文件</span></span><br><span class="line">    <span class="keyword">return</span> html_str</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    </span><br><span class="line">    get_url = <span class="string">'https://www.baidu.com/'</span></span><br><span class="line">    print(_get_page(get_url)[:<span class="number">500</span>]) <span class="comment">#请求前100字符串</span></span><br></pre></td></tr></table></figure>
<h4 id="2-requests-post实现携带请求体爬取输入框转化内容-百度翻译"><a href="#2-requests-post实现携带请求体爬取输入框转化内容-百度翻译" class="headerlink" title="2.requests-post实现携带请求体爬取输入框转化内容(百度翻译)"></a>2.requests-post实现携带请求体爬取输入框转化内容(百度翻译)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> retrying <span class="keyword">import</span> retry</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1"</span>,</span><br><span class="line">    <span class="string">"Referer"</span>: <span class="string">"http://fanyi.baidu.com/?aldtype=16047"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">query_data = &#123;</span><br><span class="line">    <span class="string">"query"</span>: <span class="string">"人生苦短，我用python"</span>,             <span class="comment">#此处可以用input输入字符串</span></span><br><span class="line">    <span class="string">"from"</span>: <span class="string">"zh"</span>,</span><br><span class="line">    <span class="string">"to"</span>: <span class="string">"en"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">@retry(stop_max_attempt_number=3) #连续请求三次，三次都失败报错</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_page</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="string">"""服务器请求"""</span></span><br><span class="line">    print(<span class="string">"*"</span>*<span class="number">10</span>)       <span class="comment">#服务器请求检验</span></span><br><span class="line">    r = requests.post(url,headers=headers,data=query_data,timeout=<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">return</span> r.content.decode()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_page</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        html_str = get_page(url)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        html_str = <span class="keyword">None</span></span><br><span class="line">    <span class="keyword">return</span> html_str</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    url = <span class="string">'http://fanyi.baidu.com/basetrans'</span></span><br><span class="line">    <span class="comment">#print(_get_page(url)) #输出类似字典，但是json字符串</span></span><br><span class="line">    page_dict = json.loads(_get_page(url))</span><br><span class="line">    print(page_dict[<span class="string">'trans'</span>][<span class="number">0</span>][<span class="string">'dst'</span>])</span><br></pre></td></tr></table></figure>
<h4 id="3-cookies请求登录后服务器保留密码的页面-人人网"><a href="#3-cookies请求登录后服务器保留密码的页面-人人网" class="headerlink" title="3.cookies请求登录后服务器保留密码的页面(人人网)"></a>3.cookies请求登录后服务器保留密码的页面(人人网)</h4><ul>
<li>headers直接携带cookie请求</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> retrying <span class="keyword">import</span> retry</span><br><span class="line"></span><br><span class="line"><span class="comment">#将请求成功的cookie信息放入headers，直接携带请求</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"User_Agent"</span>:<span class="string">"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1"</span>,</span><br><span class="line">    <span class="string">"Cookie"</span>: <span class="string">"anonymid=jl6plze3-antvfl; _r01_=1; ln_uact=17318646019; ln_hurl=http://head.xiaonei.com/photos/0/0/men_main.gif; _de=71EA9E23AC1F39D48A6CD3B85E99E01A; depovince=SC; JSESSIONID=abcnrx7CjMin0-AScWtww; ick_login=9a8e1f1c-6cd8-4700-afa6-8cf5315d36c2; jebe_key=8be431ea-e18e-4feb-ab4b-0472222a3513%7C819b727b2164a924b41678741330f60a%7C1535114212567%7C1%7C1535782169180; _ga=GA1.2.609958396.1535782958; _gid=GA1.2.2069950083.1535782958; jebecookies=2f5e7612-0f24-4f28-a1ff-52b96074e414|||||; p=fddc828d0aeca708377ca86756cd44342; first_login_flag=1; t=84129fe73a07099108643adb89c95ad52; societyguester=84129fe73a07099108643adb89c95ad52; id=967724772; xnsid=6c333906; ver=7.0; loginfrom=null; wp_fold=0"</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@retry(stop_max_attempt_number=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_page</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="string">"""请求服务器响应"""</span></span><br><span class="line">    print(<span class="string">'*'</span>*<span class="number">10</span>)</span><br><span class="line">    response = requests.get(url,headers=headers,timeout=<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">return</span> response.content.decode()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_page</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        html_str = get_page(url)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        html_str = <span class="keyword">None</span></span><br><span class="line">    <span class="keyword">return</span> html_str</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    url = <span class="string">'http://www.renren.com/967724772/profile'</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'renren2.txt'</span>,<span class="string">'w'</span>,encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(_get_page(url))</span><br></pre></td></tr></table></figure>
<ul>
<li>cookie作为字符串+字典推导式(人人网)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> retrying <span class="keyword">import</span> retry</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"User_Agent"</span>:<span class="string">"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1"</span>,</span><br><span class="line">    <span class="comment">#"Referer": "http://www.renren.com/967724772"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#cookie字符串</span></span><br><span class="line">cookie=<span class="string">"anonymid=jl6plze3-antvfl; _r01_=1; ln_uact=17318646019; ln_hurl=http://head.xiaonei.com/photos/0/0/men_main.gif; _de=71EA9E23AC1F39D48A6CD3B85E99E01A; depovince=SC; jebe_key=8be431ea-e18e-4feb-ab4b-0472222a3513%7C819b727b2164a924b41678741330f60a%7C1535114212567%7C1%7C1535782169180; _ga=GA1.2.609958396.1535782958; _gid=GA1.2.2069950083.1535782958; fenqi_user_city=36; jebecookies=35d2c64d-78b8-41ef-b5e4-4c887424f2ac|||||; JSESSIONID=abcJLhFJVpWjx73Ufvyww; ick_login=f74bfdc3-17bf-44a5-8227-33b2b0e79e89; p=f527cef24d899db1c7795ed77b5494772; first_login_flag=1; t=f634330753378f3c9eb40dd69dcd74c72; societyguester=f634330753378f3c9eb40dd69dcd74c72; id=967724772; xnsid=67ab8568; ver=7.0; loginfrom=null; wp_fold=0"</span></span><br><span class="line"></span><br><span class="line">cookie_dict = &#123;i.split(<span class="string">"="</span>)[<span class="number">0</span>]:i.split(<span class="string">"="</span>)[<span class="number">-1</span>]<span class="keyword">for</span> i <span class="keyword">in</span> cookie.split(<span class="string">"; "</span>)&#125;   <span class="comment">#字典推导式，将字符串转化为字典</span></span><br><span class="line"><span class="comment">#print(cookie_dict)   </span></span><br><span class="line"></span><br><span class="line"><span class="meta">@retry(stop_max_attempt_number=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_page</span><span class="params">(url)</span>:</span></span><br><span class="line">    print(<span class="string">'*'</span>*<span class="number">10</span>)</span><br><span class="line">    r = requests.get(url,headers=headers,cookies=cookie_dict,timeout=<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">return</span> r.content.decode()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_page</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        html_str = get_page(url)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        html_str = <span class="keyword">None</span></span><br><span class="line">    <span class="keyword">return</span> html_str</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    url = <span class="string">"http://www.renren.com/967724772/profile"</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'renren2.txt'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(_get_page(url))</span><br></pre></td></tr></table></figure>
<p>####4. post请求页面，保存登录后的cookies信息到本地session</p>
<ul>
<li>注意: <code>验证码待解决,没有实现session访问，存有疑问！！！</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> retrying <span class="keyword">import</span> retry</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"User_Agent"</span>:<span class="string">"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1"</span>,</span><br><span class="line">    <span class="comment">#"Referer": "http://www.renren.com/967724772"</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">#登录界面输入框内容和action网址</span></span><br><span class="line">query_data = &#123;</span><br><span class="line">    <span class="string">"email"</span>:<span class="string">"17318646019"</span>,</span><br><span class="line">    <span class="string">"password"</span>:<span class="string">"******"</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#实例化session</span></span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line"><span class="meta">@retry(stop_max_attempt_number=3)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_page</span><span class="params">(post_url,url)</span>:</span></span><br><span class="line">    <span class="comment">#先发送post请求，获取cookie,带上cookie请求登录后的页面</span></span><br><span class="line">    session.post(post_url,headers=headers,data=query_data) <span class="comment">#本地cookie保存到session</span></span><br><span class="line">    <span class="comment">#使用session请求登录后的页面</span></span><br><span class="line">    response = session.get(url,headers=headers)</span><br><span class="line">    <span class="keyword">return</span> response.content.decode()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    post_url = <span class="string">"http://www.renren.com/PLogin.do"</span></span><br><span class="line">    url = <span class="string">"http://www.renren.com/967724772/profile"</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'renren_session_cookie.txt'</span>,<span class="string">'w'</span>,encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(_get_page(post_url,url))</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/python爬虫/">python爬虫</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/requests模块/">requests模块</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/三种不同类型的网页爬取/">三种不同类型的网页爬取</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-python基础" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2018/08/27/python基础/" class="article-date">
      <time datetime="2018-08-27T03:35:24.000Z" itemprop="datePublished">2018-08-27</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2018/08/27/python基础/">python基础</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/待续/">待续...</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
  

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2018 成熟的汪
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo &nbsp;&nbsp;</a><a href="https://github.com/maochunguang" target="_blank">Blog</a> by tommy
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 1;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'xxxxx', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?xxxxxx";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>



<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>